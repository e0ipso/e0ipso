Code and original idea from https://github.com/bnb/bitandbang.